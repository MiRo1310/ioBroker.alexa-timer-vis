{
  "version": 3,
  "sources": ["../../src/lib/logging.ts"],
  "sourcesContent": ["import store from '@/store/store';\nimport type AlexaTimerVis from '@/main';\n\ntype SentryLevels = 'fatal' | 'error' | 'warning' | 'log' | 'info' | 'debug';\nexport type AdditionalInformation = [string, any];\n\ninterface CaptureMessage {\n    title: string;\n    e: any;\n    additionalInfos?: AdditionalInformation[];\n    level?: SentryLevels;\n}\n\nclass ErrorLoggerClass {\n    private Sentry: any;\n    private adapter: AlexaTimerVis | undefined;\n\n    init(): void {\n        const { adapter } = store;\n        this.adapter = adapter;\n        if (adapter?.supportsFeature && adapter.supportsFeature('PLUGINS')) {\n            const sentryInstance = adapter.getPluginInstance('sentry');\n            if (sentryInstance) {\n                this.Sentry = sentryInstance.getSentryObject();\n            }\n        }\n    }\n\n    send({ title, e, additionalInfos, level = 'error' }: CaptureMessage): void {\n        if (additionalInfos) {\n            this.sendMessageToSentry(title, level, additionalInfos, e);\n        } else {\n            this.sendErrorToSentry(e);\n        }\n        this.iobrokerLogging(title, e);\n    }\n\n    private sendErrorToSentry(e: any): void {\n        this.Sentry?.captureException(e);\n    }\n\n    private sendMessageToSentry(title: string, level: SentryLevels, infos: AdditionalInformation[], e: any): void {\n        this.Sentry?.withScope((scope: any) => {\n            scope.setLevel(level);\n            for (const [label, value] of infos) {\n                scope.setExtra(label, value);\n            }\n            scope.setExtra('Exception', e);\n            this.Sentry.captureMessage(title, level);\n        });\n    }\n\n    iobrokerLogging(title: string, e: any): void {\n        if (!this.adapter?.log) {\n            console.log(title, e);\n            return;\n        }\n        this.adapter.log.error(title);\n\n        this.adapter.log.error(`Error message: ${e.message}`);\n        this.adapter.log.error(`Error stack: ${e.stack}`);\n        if (e?.response) {\n            this.adapter.log.error(`Server response: ${e?.response?.status}`);\n        }\n        if (e?.response) {\n            this.adapter.log.error(`Server status: ${e?.response?.statusText}`);\n        }\n    }\n}\n\nexport default new ErrorLoggerClass();\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAkB;AAalB,MAAM,iBAAiB;AAAA,EACX;AAAA,EACA;AAAA,EAER,OAAa;AACT,UAAM,EAAE,QAAQ,IAAI,aAAAA;AACpB,SAAK,UAAU;AACf,SAAI,mCAAS,oBAAmB,QAAQ,gBAAgB,SAAS,GAAG;AAChE,YAAM,iBAAiB,QAAQ,kBAAkB,QAAQ;AACzD,UAAI,gBAAgB;AAChB,aAAK,SAAS,eAAe,gBAAgB;AAAA,MACjD;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,KAAK,EAAE,OAAO,GAAG,iBAAiB,QAAQ,QAAQ,GAAyB;AACvE,QAAI,iBAAiB;AACjB,WAAK,oBAAoB,OAAO,OAAO,iBAAiB,CAAC;AAAA,IAC7D,OAAO;AACH,WAAK,kBAAkB,CAAC;AAAA,IAC5B;AACA,SAAK,gBAAgB,OAAO,CAAC;AAAA,EACjC;AAAA,EAEQ,kBAAkB,GAAc;AArC5C;AAsCQ,eAAK,WAAL,mBAAa,iBAAiB;AAAA,EAClC;AAAA,EAEQ,oBAAoB,OAAe,OAAqB,OAAgC,GAAc;AAzClH;AA0CQ,eAAK,WAAL,mBAAa,UAAU,CAAC,UAAe;AACnC,YAAM,SAAS,KAAK;AACpB,iBAAW,CAAC,OAAO,KAAK,KAAK,OAAO;AAChC,cAAM,SAAS,OAAO,KAAK;AAAA,MAC/B;AACA,YAAM,SAAS,aAAa,CAAC;AAC7B,WAAK,OAAO,eAAe,OAAO,KAAK;AAAA,IAC3C;AAAA,EACJ;AAAA,EAEA,gBAAgB,OAAe,GAAc;AApDjD;AAqDQ,QAAI,GAAC,UAAK,YAAL,mBAAc,MAAK;AACpB,cAAQ,IAAI,OAAO,CAAC;AACpB;AAAA,IACJ;AACA,SAAK,QAAQ,IAAI,MAAM,KAAK;AAE5B,SAAK,QAAQ,IAAI,MAAM,kBAAkB,EAAE,OAAO,EAAE;AACpD,SAAK,QAAQ,IAAI,MAAM,gBAAgB,EAAE,KAAK,EAAE;AAChD,QAAI,uBAAG,UAAU;AACb,WAAK,QAAQ,IAAI,MAAM,qBAAoB,4BAAG,aAAH,mBAAa,MAAM,EAAE;AAAA,IACpE;AACA,QAAI,uBAAG,UAAU;AACb,WAAK,QAAQ,IAAI,MAAM,mBAAkB,4BAAG,aAAH,mBAAa,UAAU,EAAE;AAAA,IACtE;AAAA,EACJ;AACJ;AAEA,IAAO,kBAAQ,IAAI,iBAAiB;",
  "names": ["store"]
}
